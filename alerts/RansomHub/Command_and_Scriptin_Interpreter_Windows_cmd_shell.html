<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>Alert: Windows Command Shell</title>
  <style>
    body { font-family: Segoe UI, Arial, sans-serif; margin: 2rem; background: #f6f7fb; }
    .card { background: #fff; border-radius: 10px; box-shadow: 0 2px 6px #bbb; padding: 2rem; max-width: 700px; margin: auto; }
    h1 { margin-top: 0; font-size: 2rem; }
    .desc, .id, .link, .author, .tactic, .status { margin-bottom: 1.1em; }
    .meta { font-size: .95em; color: #555; margin-bottom: .8em; }
    .section { font-size: .99em; }
    .scenario-block { background: #f4f0d9; border-radius: 7px; padding: 1em 1.2em; margin-bottom: 1.2em; color:#4a4500; font-size:1.07em; border-left:5px solid #e1c553; }
    pre { background: #eee; padding: .7em 1em; border-radius: 5px; }
    code { background: #f6f6f6; padding: 2px 5px; border-radius: 2px; }
    ul { margin-left: 1.6em; }
  </style>
</head>
<body>
<div class="card">
  <h1>Alert: Windows Command Shell</h1>
  <div class="meta"><b>Technique ID:</b> T1059.003<div style='background:#eaf4ff;border-radius:8px;padding:15px 16px;margin-top:25px;'><b>Atomic Red Team – dostępne testy dla tej techniki:</b><ul><li><b>Create and Execute Batch Script</b><br><b>Polecenia testowe (powershell):</b><pre>Start-Process "#{script_path}"</pre><a href='../../scenarios/atomic_tests\T1059.003\Create_and_Execute_Batch_Script/test_1.ps1'>Pobierz test_1.ps1</a><br><b>Polecenia cleanup (powershell):</b><pre>Remove-Item "#{script_path}" -Force -ErrorAction Ignore</pre><a href='../../scenarios/atomic_tests\T1059.003\Create_and_Execute_Batch_Script/cleanup_1.ps1'>Pobierz cleanup_1.ps1</a><br></li><li><b>Writes text to a file and displays it.</b><br><b>Polecenia testowe (cmd):</b><pre>echo "#{message}" > "#{file_contents_path}" & type "#{file_contents_path}"</pre><a href='../../scenarios/atomic_tests\T1059.003\Writes_text_to_a_file_and_displays_it./test_1.cmd'>Pobierz test_1.cmd</a><br><b>Polecenia cleanup (cmd):</b><pre>del "#{file_contents_path}" >nul 2>&1</pre><a href='../../scenarios/atomic_tests\T1059.003\Writes_text_to_a_file_and_displays_it./cleanup_1.cmd'>Pobierz cleanup_1.cmd</a><br></li><li><b>Suspicious Execution via Windows Command Shell</b><br><b>Polecenia testowe (cmd):</b><pre>%LOCALAPPDATA:~-3,1%md /c echo #{input_message} > #{output_file} & type #{output_file}</pre><a href='../../scenarios/atomic_tests\T1059.003\Suspicious_Execution_via_Windows_Command/test_1.cmd'>Pobierz test_1.cmd</a><br></li><li><b>Simulate BlackByte Ransomware Print Bombing</b><br><b>Polecenia testowe (powershell):</b><pre>cmd /c "for /l %x in (1,1,#{max_to_print}) do start wordpad.exe /p #{file_to_print}" | out-null</pre><a href='../../scenarios/atomic_tests\T1059.003\Simulate_BlackByte_Ransomware_Print_Bomb/test_1.ps1'>Pobierz test_1.ps1</a><br><b>Polecenia cleanup (powershell):</b><pre>stop-process -name wordpad -force -erroraction silentlycontinue</pre><a href='../../scenarios/atomic_tests\T1059.003\Simulate_BlackByte_Ransomware_Print_Bomb/cleanup_1.ps1'>Pobierz cleanup_1.ps1</a><br></li><li><b>Command Prompt read contents from CMD file and execute</b><br><b>Polecenia testowe (cmd):</b><pre>cmd /r cmd<"#{input_file}"</pre><a href='../../scenarios/atomic_tests\T1059.003\Command_Prompt_read_contents_from_CMD_fi/test_1.cmd'>Pobierz test_1.cmd</a><br></li><li><b>Command prompt writing script to file then executes it</b><br><b>Polecenia testowe (cmd):</b><pre>c:\windows\system32\cmd.exe /c cd /d #{script_path} & echo Set objShell = CreateObject("WScript.Shell"):Set objExec = objShell.Exec("whoami"):Set objExec = Nothing:Set objShell = Nothing > #{script_name}.vbs & #{script_name}.vbs</pre><a href='../../scenarios/atomic_tests\T1059.003\Command_prompt_writing_script_to_file_th/test_1.cmd'>Pobierz test_1.cmd</a><br><b>Polecenia cleanup (cmd):</b><pre>del "#{script_name}.vbs" >nul 2>&1</pre><a href='../../scenarios/atomic_tests\T1059.003\Command_prompt_writing_script_to_file_th/cleanup_1.cmd'>Pobierz cleanup_1.cmd</a><br></li></ul><a href='https://github.com/redcanaryco/atomic-red-team/tree/master/atomics/T1059.003' target='_blank'>Zobacz wszystkie testy na GitHubie</a></div></div>
  <div class="tactic section"><b>Tactics:</b> <a href="https://attack.mitre.org/tactics/TA0002/" target="_blank">Execution (TA0002)</a></div>
  <div class="status section"><b>Status:</b> Pending</div>
  <div class="scenario-block"><b>Twój opis scenariusza:</b><br>Opis scenariusza, podatności lub techniki.</div>
  <div class="desc section"><b>MITRE Description:</b><br>Adversaries may abuse the Windows command shell for execution. The Windows command shell ([cmd](https://attack.mitre.org/software/S0106)) is the primary command prompt on Windows systems. The Windows command prompt can be used to control almost any aspect of a system, with various permission levels required for different subsets of commands. The command prompt can be invoked remotely via [Remote Services](https://attack.mitre.org/techniques/T1021) such as [SSH](https://attack.mitre.org/techniques/T1021/004).(Citation: SSH in Windows)  Batch files (ex: .bat or .cmd) also provide the shell with a list of sequential commands to run, as well as normal scripting operations such as conditionals and loops. Common uses of batch files include long or repetitive tasks, or the need to run the same set of commands on multiple systems.  Adversaries may leverage [cmd](https://attack.mitre.org/software/S0106) to execute various commands and payloads. Common uses include [cmd](https://attack.mitre.org/software/S0106) to execute a single command, or abusing [cmd](https://attack.mitre.org/software/S0106) interactively with input and output forwarded over a command and control channel.</div>
  <div class="link section"><b>MITRE Link:</b> <a href="https://attack.mitre.org/techniques/T1059/003/" target="_blank">https://attack.mitre.org/techniques/T1059/003/</a></div>
  <div class="author section"><b>Author:</b> Krzysztof K.</div>
</div>
</body>
</html>
